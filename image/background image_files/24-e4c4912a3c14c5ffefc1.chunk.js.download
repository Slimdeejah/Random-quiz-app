(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{80:function(t,e,a){"use strict";e.a=class{constructor(){this.baseState={sort:"best",license:"all",orientation:[],editor:!1,page:1,image_style:[],num_people:[],people_age:[],people_composition:[],ethnicity:[],resolution:[],aspect_ratio:[],duration:"25_90",color:"",threshold:"",wholly_owned:!1},this.defaultState=JSON.parse(JSON.stringify(this.baseState)),this.omittedArray=["content"],this.updateStateFromURL()}updateStateFromURL(){const t=this.returnURLParamState(),e=this.getRawStateString();!e&&t?this.assignDefaultsWithParams(t):e&&t?this.assignDefaultsWithParams({...this.getRawStateObject(),...t}):e||t||this.assignDefaultsWithParams({})}addPopStateListener(){window.addEventListener("popstate",()=>{this.updateStateFromURL()})}assignDefaultsWithParams(t){if(!t)throw new Error("No state object was given.");this.saveStateToSession({...this.defaultState,...t})}returnURLParamState(){const t=window.location.search.substring(1),e={};let a=null;t.split("&").forEach(t=>{const a=t.split("="),s=a.shift(),r=a.join("=");e[s]=decodeURIComponent(r)});const s=Object.keys(e);for(let r=0;r<s.length;r+=1){const t=s[r],o=t.split("-");if(Object.hasOwnProperty.call(this.defaultState,o[0])){const s=Object.prototype.toString.call(this.defaultState[o[0]]);if(null===a&&(a={}),o.length>1){const[t,e]=o;switch(s){case"[object Array]":"undefined"===typeof a[t]&&(a[t]=[]),a[t].push(e);break;default:a[t]=e}}else try{a[o[0]]=JSON.parse(e[t])}catch{a[o[0]]=e[t]}}}return a||!1}setNewDefaultState(t){this.defaultState=t,this.saveStateToSession(this.defaultState)}setDefaultState(){this.defaultState=JSON.parse(JSON.stringify(this.baseState)),this.saveStateToSession(this.defaultState)}getRawStateString(){return sessionStorage.getItem("ezSearchState")||!1}saveStateToSession(t){const e=JSON.stringify(t);sessionStorage.setItem("ezSearchState",e)}getDefaultStateObject(){return this.defaultState}getRawStateObject(){return{...JSON.parse(this.getRawStateString().toString())}}getRawParamKeys(){const t=this.getRawStateObject();return this.flattenParamKeys(t)}getParamKeys(){const t=this.getState();return this.flattenParamKeys(t)}flattenParamKeys(t){const e=Object.keys(t),a=[];return e.forEach(e=>{if("duration"!==e)switch(Object.prototype.toString.call(t[e])){case"[object Boolean]":!0===t[e]&&a.push(""+e);break;case"[object Number]":t[e]!==this.defaultState[e]&&a.push(""+e);break;case"[object Array]":t[e].length>0&&t[e].forEach(t=>{a.push(`${e}-${t}`)});break;case"[object String]":a.push(`${e}-${t[e]}`)}else a.push(""+e)}),a}generateFlatQueryString(t){const e=this.getRawStateObject();let a="",s=0;return t.forEach(t=>{"number"===typeof e[t]||"duration"===t?a+=`${0===s?"?":"&"}${encodeURIComponent(t)}=${e[t]}`:a+=`${0===s?"?":"&"}${encodeURIComponent(t)}=true`,s+=1}),a}getRawFlatQueryString(){const t=this.getRawParamKeys();return this.generateFlatQueryString(t)}getFlatQueryString(){const t=this.getParamKeys();return this.generateFlatQueryString(t)}getState(){const t=this.getRawStateObject();return{...this.filterDefaults(t)}}filterDefaults(t){const e={};return Object.keys(t).forEach(a=>{this.deepCompare(t[a],this.defaultState[a])||(e[a]=t[a])}),e}deepCompare(t,e){return JSON.stringify(t)===JSON.stringify(e)}omittedFromState(t){return this.omittedArray.includes(t)}updateStateValue(t,e){const a=this.getRawStateObject(),s=a;if("undefined"===typeof a[t])throw new Error("State key does not exist");if(typeof a[t]!==typeof e&&"boolean"!==typeof e)throw new Error(`New value typeof does not match current state. typeof state: ${typeof a[t]}, typeof value: ${typeof e}`);s[t]=e,"page"!==t&&(s.page=this.defaultState.page),this.saveStateToSession(s)}updateParamKey(t){const e=this.getRawStateObject();if("boolean"===typeof e[t])return void this.updateStateValue(t,!0);if(-1===t.indexOf("-"))throw new Error("Param key cannot be split");const[a,s]=t.split("-");"[object Array]"===Object.prototype.toString.call(e[a])?this.pushToStateArray(a,s):this.updateStateValue(a,s)}removeParamKey(t){const e=this.getRawStateObject();if("boolean"===typeof e[t])return void this.updateStateValue(t,!1);if(-1===t.indexOf("-"))throw new Error("Param key cannot be split");const[a,s]=t.split("-");"[object Array]"===Object.prototype.toString.call(e[a])?this.removeFromStateArray(a,s):this.updateStateValue(a,this.defaultState[a])}removeFromStateArray(t,e){const a=this.getRawStateObject(),s=a;if("[object Array]"!==Object.prototype.toString.call(a[t]))throw new Error("State key is not an array");if(!a[t].includes(e))throw new Error("Value does not exist in state");s[t]=a[t].filter(t=>t!==e),0===s[t].length&&(s[t]=this.defaultState[t]),"page"!==t&&(s.page=this.defaultState.page),this.saveStateToSession(s)}pushToStateArray(t,e){const a=this.getRawStateObject(),s=a;if("string"!==typeof e)throw new Error("array values must be strings");if("[object Array]"!==Object.prototype.toString.call(a[t]))throw new Error("State key is not an array");if(a[t].includes(e))throw new Error("Value already exists in state");this.deepCompare(a[t],this.defaultState[t])&&(s[t]=[]),s[t].push(e),"page"!==t&&(s.page=this.defaultState.page),this.saveStateToSession(s)}resetKeyToDefault(t){const e=this.getRawStateObject();if(!this.defaultState[t])throw Error("This key does not have a default");e[t]=this.defaultState[t],this.saveStateToSession(e)}resetStateToDefault(){this.saveStateToSession(this.defaultState),sessionStorage.setItem("user_filter_order","[]")}}}}]);
//# sourceMappingURL=24-e4c4912a3c14c5ffefc1.chunk.js.map