(window.webpackJsonp=window.webpackJsonp||[]).push([[198],{1489:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return d}));var i=n(13),a=n(16),s=n(9),o=n.n(s),c=n(6),r=n(8);class d extends i.b{connect(){this.contentRequested=!1,this.seenCookieUpdated=!1,this.activeIds=JSON.parse(this.unseenBadgeTarget.dataset.activeNotifications),this.seenIds=JSON.parse(this.unseenBadgeTarget.dataset.seenNotifications)}getMarketingNotifications(){this.contentRequested||(this.contentRequested=!0,Object(a.b)("/api/v2/marketing_notifications",t=>{this.setNotifications(t.data.marketing_notifications)},t=>{console.error(t)}))}setNotifications(t){this.spinnerTarget.classList.add("is-hidden"),0!==t.length?t.forEach((t,e)=>{const n=this.marketingTemplate(t,e+1);this.listTarget.insertAdjacentHTML("beforeend",n)}):this.noNotifications()}noNotifications(){this.listTarget.insertAdjacentHTML("beforeend",'\n      <li class="notification-item no-notifications">\n        <h3>Currently no notifications</h3>\n        <p>Please check back later</p>\n      </li>\n    ')}menuClick(t){t.currentTarget.parentNode.classList.contains("is-closed")||(this.getMarketingNotifications(),this.seenCookieUpdated||(this.seenCookieUpdated=!0,this.updateSeenCookie()),this.sendOpenClick(t,this.activeIds.length))}updateSeenCookie(){const t=this.seenIds;if(this.activeIds){this.activeIds.forEach(e=>{t.includes(e)||t.push(e)});let e=0;for(;e<t.length&&!(t.length<=100);)-1===this.activeIds.indexOf(t[e])&&(t.splice(e,1),e-=1),e+=1;o.a.set("seen_notifications",t),this.setSeenBadge()}}sendOpenClick(t,e){Object(c.k)({element:t.currentTarget,data:{action:r.ob,category:"Header",value:e}})}sendCompleteEvent(t){Object(c.k)({element:t.currentTarget,data:{action:r.pb,category:"Header",label:t.currentTarget.dataset.trackingLabel,value:parseInt(t.currentTarget.dataset.position,10)}})}marketingTemplate(t,e){const{id:n,title:i,url:a,new_tab:s,image:o,button_text:c}=t;return`\n      <li class="notification-item marketing-notification" data-id="${n}">\n        <a ${`\n      href="${a}"\n      data-action="click->notifications-menu#sendCompleteEvent"\n      data-tracking-label="${i}"\n      data-position="${e}"\n      ${s?'target="_blank"':""}\n    `}>\n          <img src="${o.large.url}" onerror="this.remove();" />\n          <h6 class="marketing-notification__title">${i}</h6>\n          <button class="ez-btn ez-btn--medium marketing-notification__btn">${c}</button>\n        </a>\n      </li>\n    `}setSeenBadge(){this.unseenBadgeTarget.innerHTML="",this.unseenBadgeTarget.classList.add("is-hidden")}}d.targets=["menuButton","list","unseenBadge","spinner"]}}]);
//# sourceMappingURL=notifications-menu-controller-c4c112d1f2ac2c25ae39.chunk.js.map